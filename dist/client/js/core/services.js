"use strict";angular.module("oto").factory("Auth",["$http","$cookieStore","$rootScope","$cookies",function(a,b,c,d){function e(a){_.extend(h,a)}var f=routingConfig.accessLevels,g=routingConfig.userRoles,h=b.get("user")||{username:"",role:g["public"]},i=d["XSRF-TOKEN"]||null;return b.remove("user"),{authorize:function(a,b){return void 0===b&&(b=h.role),a.bitMask&b.bitMask},isLoggedIn:function(a){return void 0===a&&(a=h),a.role.title==g.user.title||a.role.title==g.admin.title},register:function(b,c,d){a.post("/register",b).success(function(a){console.log(headers()),e(a),c()}).error(d)},login:function(b,c,d){a.post("/login",b).success(function(a){e(a),c(a)}).error(d)},logout:function(b,d){a.post("/logout").success(function(){e({username:"",role:g["public"]}),b(),c.core.savedLocation=null}).error(d)},accessLevels:f,userRoles:g,user:h,xsrfToken:i}}]),angular.module("oto").factory("Users",["$http",function(a){return{getAll:function(b,c){a.get("/users").success(b).error(c)},remove:function(b,c,d){a["delete"]("/users/"+b._id).success(c).error(d)},add:function(b,c,d){a.post("/users",b).success(c).error(d)},update:function(b,c,d){a.put("/users/"+b._id,b).success(c).error(d)}}}]);